@inherits LayoutComponentBase
@inject IAuthService AuthService
@inject NavigationManager Navigation

<div class="admin-layout">
    @* ---- Mobile top bar (visible < lg) ---- *@
    <header class="admin-topbar-mobile d-lg-none">
        <a href="/admin" class="admin-topbar-brand">
            <span class="admin-topbar-brand-text">NSI</span>
            <span class="admin-topbar-brand-sub">Admin</span>
        </a>
        <button class="admin-hamburger" type="button"
                data-bs-toggle="offcanvas" data-bs-target="#adminSidebar"
                aria-controls="adminSidebar" aria-label="Меню">
            <i class="bi bi-list"></i>
        </button>
    </header>

    @* ---- Sidebar: offcanvas on mobile, fixed on desktop ---- *@
    <nav class="offcanvas-lg offcanvas-start sidebar-nsi" tabindex="-1"
         id="adminSidebar" aria-labelledby="adminSidebarLabel">

        @* Offcanvas header (mobile only — Bootstrap hides it at lg+) *@
        <div class="offcanvas-header d-lg-none sidebar-offcanvas-header">
            <span class="offcanvas-title" id="adminSidebarLabel">
                <span class="sidebar-brand-name">Natural Stone Impex</span>
            </span>
            <button type="button" class="btn-close btn-close-white"
                    data-bs-dismiss="offcanvas" data-bs-target="#adminSidebar"
                    aria-label="Затвори"></button>
        </div>

        <div class="offcanvas-body sidebar-body">
            @* Brand area (desktop) *@
            <div class="sidebar-brand d-none d-lg-block">
                <a href="/admin" class="sidebar-brand-link">
                    <span class="sidebar-brand-name">Natural Stone Impex</span>
                    <span class="sidebar-brand-subtitle">Администрация</span>
                </a>
            </div>

            <div class="sidebar-divider d-none d-lg-block"></div>

            @* Main navigation *@
            <ul class="nav flex-column sidebar-nav">
                <li class="nav-item">
                    <NavLink class="nav-link" href="/admin" Match="NavLinkMatch.All">
                        <i class="bi bi-speedometer2 me-2"></i> Табло
                    </NavLink>
                </li>
                <li class="nav-item">
                    <NavLink class="nav-link" href="/admin/products">
                        <i class="bi bi-box-seam me-2"></i> Продукти
                    </NavLink>
                </li>
                <li class="nav-item">
                    <NavLink class="nav-link" href="/admin/categories">
                        <i class="bi bi-tags me-2"></i> Категории
                    </NavLink>
                </li>
                <li class="nav-item">
                    <NavLink class="nav-link" href="/admin/orders">
                        <i class="bi bi-receipt me-2"></i> Поръчки
                    </NavLink>
                </li>
                <li class="nav-item">
                    <NavLink class="nav-link" href="/admin/invoices">
                        <i class="bi bi-truck me-2"></i> Доставки
                    </NavLink>
                </li>
            </ul>

            <div class="sidebar-divider"></div>

            @* Secondary nav *@
            <ul class="nav flex-column sidebar-nav">
                <li class="nav-item">
                    <a class="nav-link sidebar-link-external" href="/">
                        <i class="bi bi-arrow-left me-2"></i> Към сайта
                        <i class="bi bi-box-arrow-up-right sidebar-external-icon"></i>
                    </a>
                </li>
            </ul>

            @* Logout — pushed to bottom *@
            <div class="sidebar-footer">
                <div class="sidebar-divider"></div>
                <button class="btn sidebar-btn-logout w-100" @onclick="HandleLogout">
                    <i class="bi bi-box-arrow-right me-2"></i> Изход
                </button>
            </div>
        </div>
    </nav>

    @* ---- Main content area ---- *@
    <div class="admin-content">
        <header class="admin-content-topbar d-none d-lg-flex">
            <span class="admin-content-topbar-text">Административен панел</span>
        </header>
        <main class="admin-main" @key="Navigation.Uri">
            @Body
        </main>
    </div>
</div>

@code {
    private void HandleLogout()
    {
        AuthService.Logout();
        Navigation.NavigateTo("/admin/login");
    }
}
